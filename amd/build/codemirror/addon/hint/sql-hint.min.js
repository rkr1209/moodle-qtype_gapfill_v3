function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a){if("object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module)))a(require("../../lib/codemirror"),require("../../mode/sql/sql"));else if("function"==typeof define&&define.amd)define ("qtype_gapfill/codemirror/addon/hint/sql-hint",["../../lib/codemirror","../../mode/sql/sql"],a);else a(CodeMirror)})(function(a){"use strict";var r,s,t,u,v={QUERY_DIV:";",ALIAS_KEYWORD:"AS"},w=a.Pos,x=a.cmpPos;function b(a){return"[object Array]"==Object.prototype.toString.call(a)}function c(b){var c=b.doc.modeOption;if("sql"===c)c="text/x-sql";return a.resolveMode(c).keywords}function d(b){var c=b.doc.modeOption;if("sql"===c)c="text/x-sql";return a.resolveMode(c).identifierQuote||"`"}function e(a){return"string"==typeof a?a:a.text}function f(a,c){if(b(c))c={columns:c};if(!c.text)c.text=a;return c}function g(a){var c={};if(b(a)){for(var d=a.length-1,g;0<=d;d--){g=a[d];c[e(g).toUpperCase()]=f(e(g),g)}}else if(a){for(var h in a){c[h.toUpperCase()]=f(h,a[h])}}return c}function h(a){return r[a.toUpperCase()]}function j(a){var b={};for(var c in a){if(a.hasOwnProperty(c))b[c]=a[c]}return b}function k(a,b){var c=a.length,d=e(b).substr(0,c);return a.toUpperCase()===d.toUpperCase()}function l(a,c,d,e){if(b(d)){for(var f=0;f<d.length;f++){if(k(c,d[f]))a.push(e(d[f]))}}else{for(var g in d){if(d.hasOwnProperty(g)){var h=d[g];if(!h||!0===h)h=g;else h=h.displayText?{text:h.text,displayText:h.displayText}:h.text;if(k(c,h))a.push(e(h))}}}}function m(a){if("."==a.charAt(0)){a=a.substr(1)}for(var b=a.split(u+u),c=0;c<b.length;c++){b[c]=b[c].replace(new RegExp(u,"g"),"")}return b.join(u)}function n(a){for(var b=e(a).split("."),c=0;c<b.length;c++){b[c]=u+b[c].replace(new RegExp(u,"g"),u+u)+u}var d=b.join(".");if("string"==typeof a)return d;a=j(a);a.text=d;return a}function o(a,b,c,d){var e=!1,f=[],g=b.start,i=!0;while(i){i="."==b.string.charAt(0);e=e||b.string.charAt(0)==u;g=b.start;f.unshift(m(b.string));b=d.getTokenAt(w(a.line,b.start));if("."==b.string){i=!0;b=d.getTokenAt(w(a.line,b.start))}}var k=f.join(".");l(c,k,r,function(a){return e?n(a):a});l(c,k,s,function(a){return e?n(a):a});k=f.pop();var o=f.join("."),p=!1,t=o;if(!h(o)){var v=o;o=q(o,d);if(o!==v)p=!0}var x=h(o);if(x&&x.columns)x=x.columns;if(x){l(c,k,x,function(a){var b=o;if(!0==p)b=t;if("string"==typeof a){a=b+"."+a}else{a=j(a);a.text=b+"."+a.text}return e?n(a):a})}return g}function p(a,b){for(var c=a.split(/\s+/),d=0;d<c.length;d++){if(c[d])b(c[d].replace(/[`,;]/g,""))}}function q(a,b){var c=b.doc,d=c.getValue(),e=a.toUpperCase(),f="",g="",j=[],k={start:w(0,0),end:w(b.lastLine(),b.getLineHandle(b.lastLine()).length)},l=d.indexOf(v.QUERY_DIV);while(-1!=l){j.push(c.posFromIndex(l));l=d.indexOf(v.QUERY_DIV,l+1)}j.unshift(w(0,0));j.push(w(b.lastLine(),b.getLineHandle(b.lastLine()).text.length));for(var m=null,n=b.getCursor(),o=0;o<j.length;o++){if((null==m||0<x(n,m))&&0>=x(n,j[o])){k={start:m,end:j[o]};break}m=j[o]}if(k.start){for(var q=c.getRange(k.start,k.end,!1),o=0,r;o<q.length;o++){r=q[o];p(r,function(a){var b=a.toUpperCase();if(b===e&&h(f))g=f;if(b!==v.ALIAS_KEYWORD)f=a});if(g)break}}return g}a.registerHelper("hint","sql",function(a,b){r=g(b&&b.tables);var e=b&&b.defaultTable,f=b&&b.disableKeywords;s=e&&h(e);t=c(a);u=d(a);if(e&&!s)s=q(e,a);s=s||[];if(s.columns)s=s.columns;var i=a.getCursor(),j=[],k=a.getTokenAt(i),m,n,p;if(k.end>i.ch){k.end=i.ch;k.string=k.string.slice(0,i.ch-k.start)}if(k.string.match(/^[.`"'\w@][\w$#]*$/g)){p=k.string;m=k.start;n=k.end}else{m=n=i.ch;p=""}if("."==p.charAt(0)||p.charAt(0)==u){m=o(i,k,j,a)}else{var v=function(a,b){if("object"===_typeof(a)){a.className=b}else{a={text:a,className:b}}return a};l(j,p,s,function(a){return v(a,"CodeMirror-hint-table CodeMirror-hint-default-table")});l(j,p,r,function(a){return v(a,"CodeMirror-hint-table")});if(!f)l(j,p,t,function(a){return v(a.toUpperCase(),"CodeMirror-hint-keyword")})}return{list:j,from:w(i.line,m),to:w(i.line,n)}})});
//# sourceMappingURL=sql-hint.min.js.map
